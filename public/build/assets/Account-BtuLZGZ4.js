import{C as T,D,u as C,a9 as K,N as L,b as v,a3 as E,c as _,e as l,d as o,f as s,l as I,aa as R,j as M,k as p,m as w,i as V,t as i,I as x,x as W}from"./app-CLj7mONa.js";import{t as j}from"./tabs-DgL9eyj5.js";import{F}from"./Form-CUtLPPZs.js";/*! 2FAuth version 6.0.0 - Copyright (c) 2025 Bubka - https://github.com/Bubka/2FAuth */const z={class:"options-tabs"},H={key:0,class:"notification is-warning"},q={key:1,class:"notification is-info has-text-centered"},G={key:0,class:"notification is-warning has-text-centered"},J={class:"title is-4 has-text-grey-light"},O=["disabled"],Q=["value"],X=["value"],Y={class:"title is-4 pt-6 has-text-grey-light"},Z=["disabled"],ee=["value"],se=["value"],te={class:"title is-4 pt-6 has-text-danger"},oe={class:"field is-size-7-mobile"},ae={class:"block"},re=["disabled"],ue={__name:"Account",setup(ne){const g=T(),{t:h}=D(),c=L("2fauth"),d=C(),u=W(),y=I(),$=K(c.prefix+"returnTo","accounts"),r=v(new F({name:d.name,email:d.email,password:""})),n=v(new F({currentPassword:"",password:"",password_confirmation:""})),m=v(new F({password:""}));function N(a){r.put("/user",{returnError:!0}).then(e=>{d.$patch({name:e.data.name,email:e.data.email,isAdmin:e.data.is_admin}),u.success({text:h("notification.profile_saved")})}).catch(e=>{e.response.status===400?u.alert({text:e.response.data.message}):e.response.status!==422&&g.show(e)})}function P(a){n.patch("/user/password",{returnError:!0}).then(e=>{n.password="",n.formPassword="",n.password_confirmation="",u.success({text:e.data.message})}).catch(e=>{e.response.status===400?u.alert({text:e.response.data.message}):e.response.status!==422&&g.show(e)})}function S(a){confirm(h("confirmation.delete_account"))&&m.delete("/user",{returnError:!0}).then(e=>{u.success({text:h("notification.user_account_successfully_deleted")}),y.push({name:"register"})}).catch(e=>{e.response.status===400?u.alert({text:e.response.data.message}):e.response.status!==422&&g.show(e)})}return E(a=>{!a.name.startsWith("settings.")&&a.name==="login"&&u.clear()}),(a,e)=>{const f=p("FormField"),b=p("FormButtons"),B=p("FormPasswordField"),A=p("FormWrapper"),U=p("NavigationButton"),k=p("VueFooter");return w(),_("div",null,[l(s(R),{tabs:s(j),"active-tab":"settings.account",onTabSelected:e[0]||(e[0]=t=>s(y).push({name:t}))},null,8,["tabs"]),o("div",z,[l(A,null,{default:M(()=>[s(d).isAdmin?(w(),_("div",H,i(a.$t("message.you_are_administrator")),1)):V("",!0),s(d).oauth_provider?(w(),_("div",q,i(a.$t("message.account_linked_to_sso_x_provider",{provider:s(d).oauth_provider})),1)):V("",!0),o("form",{onSubmit:x(N,["prevent"]),onKeydown:e[4]||(e[4]=t=>s(r).onKeydown(t))},[s(c).config.proxyAuth?(w(),_("div",G,i(a.$t("message.user_account_controlled_by_proxy")+" "+a.$t("message.manage_account_at_proxy_level")),1)):V("",!0),o("h4",J,i(a.$t("heading.profile")),1),o("fieldset",{disabled:s(c).config.proxyAuth||s(d).oauth_provider},[l(f,{modelValue:s(r).name,"onUpdate:modelValue":e[1]||(e[1]=t=>s(r).name=t),fieldName:"name",errorMessage:s(r).errors.get("name"),label:"field.name",maxLength:255,autocomplete:"username",autofocus:""},null,8,["modelValue","errorMessage"]),l(f,{modelValue:s(r).email,"onUpdate:modelValue":e[2]||(e[2]=t=>s(r).email=t),fieldName:"email",errorMessage:s(r).errors.get("email"),inputType:"email",label:"field.email",autocomplete:"email",maxLength:255,autofocus:""},null,8,["modelValue","errorMessage"]),l(f,{modelValue:s(r).password,"onUpdate:modelValue":e[3]||(e[3]=t=>s(r).password=t),fieldName:"password",errorMessage:s(r).errors.get("password"),inputType:"password",label:"field.current_password",autocomplete:"current-password",help:"field.current_password.help"},null,8,["modelValue","errorMessage"]),l(b,{isBusy:s(r).isBusy,submitLabel:"label.update"},null,8,["isBusy"])],8,O)],32),o("form",{onSubmit:x(P,["prevent"]),onKeydown:e[8]||(e[8]=t=>s(n).onKeydown(t))},[o("input",{hidden:"",type:"text",name:"name",value:s(r).name,autocomplete:"username"},null,8,Q),o("input",{hidden:"",type:"text",name:"email",value:s(r).email,autocomplete:"email"},null,8,X),o("h4",Y,i(a.$t("heading.change_password")),1),o("fieldset",{disabled:s(c).config.proxyAuth||s(d).oauth_provider},[l(B,{modelValue:s(n).password,"onUpdate:modelValue":e[5]||(e[5]=t=>s(n).password=t),fieldName:"password",errorMessage:s(n).errors.get("password"),idSuffix:"ForUpdate",autocomplete:"new-password",showRules:!0,label:"field.new_password"},null,8,["modelValue","errorMessage"]),l(B,{modelValue:s(n).password_confirmation,"onUpdate:modelValue":e[6]||(e[6]=t=>s(n).password_confirmation=t),showRules:!1,fieldName:"password_confirmation",errorMessage:s(n).errors.get("password_confirmation"),inputType:"password",autocomplete:"new-password",label:"field.confirm_new_password"},null,8,["modelValue","errorMessage"]),l(f,{modelValue:s(n).currentPassword,"onUpdate:modelValue":e[7]||(e[7]=t=>s(n).currentPassword=t),fieldName:"currentPassword",errorMessage:s(n).errors.get("currentPassword"),inputType:"password",label:"field.current_password",autocomplete:"current-password",help:"field.current_password.help"},null,8,["modelValue","errorMessage"]),l(b,{isBusy:s(n).isBusy,submitId:"btnSubmitChangePwd",submitLabel:"label.change_password"},null,8,["isBusy"])],8,Z)],32),o("form",{id:"frmDeleteAccount",onSubmit:x(S,["prevent"]),onKeydown:e[10]||(e[10]=t=>s(m).onKeydown(t))},[o("input",{hidden:"",type:"text",name:"name",value:s(r).name,autocomplete:"username"},null,8,ee),o("input",{hidden:"",type:"text",name:"email",value:s(r).email,autocomplete:"email"},null,8,se),o("h4",te,i(a.$t("heading.delete_account")),1),o("div",oe,[o("p",ae,i(a.$t("message.delete_your_account_and_reset_all_data")),1),o("p",null,i(a.$t("message.reset_your_password_to_delete_your_account")),1),o("p",null,i(a.$t("message.deleting_2fauth_account_does_not_impact_provider")),1)]),o("fieldset",{disabled:s(c).config.proxyAuth},[l(f,{modelValue:s(m).password,"onUpdate:modelValue":e[9]||(e[9]=t=>s(m).password=t),fieldName:"password",errorMessage:s(m).errors.get("password"),inputType:"password",idSuffix:"ForDelete",autocomplete:"new-password",label:"field.current_password",help:"field.current_password.help"},null,8,["modelValue","errorMessage"]),l(b,{isBusy:s(m).isBusy,submitLabel:"label.delete_your_account",submitId:"btnDeleteAccount",color:"is-danger"},null,8,["isBusy"])],8,re)],32)]),_:1})]),l(k,null,{default:M(()=>[l(U,{action:"close",onClosed:e[11]||(e[11]=t=>s(y).push({name:s($)})),"current-page-title":a.$t("title.settings.account")},null,8,["current-page-title"])]),_:1})])}}};export{ue as default};
