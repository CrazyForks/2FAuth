import{C as H,N as T,r as y,v as P,o as R,Y as q,k as V,c,m as n,h as r,i as Y,E as G,f as e,R as J,d as s,n as i,t as l,e as x,F as B,G as X,j as _,g as M}from"./app-CLj7mONa.js";import{U as K}from"./index-DHvNF7PZ.js";import{c as k}from"./createLucideIcon-DUteC7o6.js";import{X as Q}from"./x-BF3-YSPD.js";import{C as W}from"./check-BaUiYB3M.js";/*! 2FAuth version 6.0.0 - Copyright (c) 2025 Bubka - https://github.com/Bubka/2FAuth *//**
 * @license lucide-vue-next v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=k("calendar-arrow-down",[["path",{d:"m14 18 4 4 4-4",key:"1waygx"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M18 14v8",key:"irew45"}],["path",{d:"M21 11.354V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h7.343",key:"bse4f3"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}]]);/**
 * @license lucide-vue-next v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=k("calendar-arrow-up",[["path",{d:"m14 18 4-4 4 4",key:"ftkppy"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M18 22v-8",key:"su0gjh"}],["path",{d:"M21 11.343V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h9",key:"1exg90"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}]]);/**
 * @license lucide-vue-next v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=k("monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-vue-next v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=k("smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-vue-next v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=k("tablet",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["line",{x1:"12",x2:"12.01",y1:"18",y2:"18",key:"1dp563"}]]),at={key:1,class:"level is-mobile mb-2"},nt={class:"level-item has-text-centered"},lt={class:"buttons"},rt=["title"],it=["title"],ht=["title"],dt=["title"],ct=["title"],ut=["title"],gt={key:3,class:"mt-4"},pt={key:4},yt={class:"light-or-darker"},_t={class:"light-or-darker"},kt={class:"light-or-darker"},mt={class:"light-or-darker"},vt={class:"light-or-darker"},bt={class:"light-or-darker"},ft={class:"light-or-darker"},wt={class:"log-icon-wrapper"},xt={key:5,class:"mt-5 pl-3"},Nt={__name:"AccessLogViewer",props:{userId:[Number,String],lastOnly:Boolean,showSearch:Boolean,period:{type:[Number,String],default:12}},emits:["has-more-entries"],setup(L,{emit:D}){const O=H(),I=T("2fauth"),u=L,h={aMonth:1,threeMonths:3,halfYear:6,aYear:12},d=y([]),f=y(!1),m=y(""),g=y(u.period),p=y(!0),j=D,S=P(()=>d.value.filter(t=>JSON.stringify(t).toString().toLowerCase().includes(m.value)));R(()=>{A()});function v(t){g.value=t,A()}function E(){p.value=!1,$()}function $(){d.value.sort((t,a)=>t.id>a.id?1:-1)}function F(){p.value=!0,C()}function C(){d.value.sort((t,a)=>t.id<a.id?1:-1)}function A(){f.value=!0;let t=u.lastOnly?4:!1;q.getauthentications(u.userId,g.value,t,{returnError:!0}).then(a=>{d.value=a.data,d.value.length>3&&u.lastOnly&&(j("has-more-entries"),d.value.pop()),p.value==!0?C():$()}).catch(a=>{O.show(a)}).finally(()=>{f.value=!1})}const U=t=>!t.login_at&&t.logout_at,N=t=>!t.login_successful&&!t.logout_at;return(t,a)=>{const z=V("Spinner"),b=V("i18n-t");return n(),c(B,null,[u.showSearch?(n(),r(e(J),{key:0,keyword:e(m),"onUpdate:keyword":a[0]||(a[0]=o=>G(m)?m.value=o:null),hasNoBackground:!0},null,8,["keyword"])):Y("",!0),u.showSearch?(n(),c("nav",at,[s("div",nt,[s("div",lt,[s("button",{id:"btnShowOneMonth",title:t.$t("tooltip.show_last_month_log"),onClick:a[1]||(a[1]=o=>v(h.aMonth)),class:i([{"has-text-grey":e(g)!==h.aMonth},"button is-ghost p-1"]),type:"button"},l(t.$t("label.one_month")),11,rt),s("button",{id:"btnShowThreeMonths",title:t.$t("tooltip.show_three_months_log"),onClick:a[2]||(a[2]=o=>v(h.threeMonths)),class:i([{"has-text-grey":e(g)!==h.threeMonths},"button is-ghost p-1"]),type:"button"},l(t.$t("label.x_month",{x:"3"})),11,it),s("button",{id:"btnShowSixMonths",title:t.$t("tooltip.show_six_months_log"),onClick:a[3]||(a[3]=o=>v(h.halfYear)),class:i([{"has-text-grey":e(g)!==h.halfYear},"button is-ghost p-1"]),type:"button"},l(t.$t("label.x_month",{x:"6"})),11,ht),s("button",{id:"btnShowOneYear",title:t.$t("tooltip.show_one_year_log"),onClick:a[4]||(a[4]=o=>v(h.aYear)),class:i([{"has-text-grey":e(g)!==h.aYear},"button is-ghost p-1 mr-5"]),type:"button"},l(t.$t("label.one_year")),11,dt),s("button",{id:"btnSortLogDesc",onClick:F,title:t.$t("tooltip.sort_by_date_desc"),class:i([{"has-text-grey":!e(p)},"button p-1 is-ghost"]),type:"button"},[x(e(Z))],10,ct),s("button",{id:"btnSortLogAsc",onClick:E,title:t.$t("tooltip.sort_by_date_asc"),class:i([{"has-text-grey":e(p)},"button p-1 is-ghost"]),type:"button"},[x(e(tt))],10,ut)])])])):Y("",!0),e(f)?(n(),r(z,{key:2,isVisible:!0,type:"list-loading"})):e(d).length==0?(n(),c("div",gt,l(t.$t("message.no_entry_yet")),1)):e(S).length>0?(n(),c("div",pt,[(n(!0),c(B,null,X(e(S),o=>(n(),c("div",{key:o.id,class:"list-item is-size-6 is-size-7-mobile has-text-grey is-flex is-justify-content-space-between"},[x(e(K),null,{default:_(({mode:w})=>[s("div",null,[s("div",null,[N(o)?(n(),r(b,{key:0,keypath:"message.failed_login_on",tag:"span"},{login_at:_(()=>[s("span",yt,l(o.login_at),1)]),_:2},1024)):U(o)?(n(),r(b,{key:1,keypath:"message.successful_logout_on",tag:"span"},{logout_at:_(()=>[s("span",_t,l(o.logout_at),1)]),_:2},1024)):e(I).config.proxyAuth?(n(),r(b,{key:2,keypath:"message.viewed_on",tag:"span"},{login_at:_(()=>[s("span",kt,l(o.login_at),1)]),_:2},1024)):(n(),r(b,{key:3,keypath:"message.successful_login_on",tag:"span"},{login_at:_(()=>[s("span",mt,l(o.login_at),1)]),_:2},1024))]),s("div",null,[M(l(t.$t("label.IP"))+": ",1),s("span",vt,l(o.ip_address),1),M(" - "+l(t.$t("label.browser"))+": ",1),s("span",bt,l(o.browser),1),M(" - "+l(t.$t("label.operating_system_short"))+": ",1),s("span",ft,l(o.platform),1)])]),s("div",{class:i([w=="dark"?"has-text-grey-darker":"has-text-grey-lighter","is-align-self-center"])},[s("div",wt,[o.device=="phone"?(n(),r(e(st),{key:0,class:"log-icon-bg"})):o.device=="tablet"?(n(),r(e(ot),{key:1,class:"log-icon-bg"})):(n(),r(e(et),{key:2,class:"log-icon-bg"})),N(o)?(n(),r(e(Q),{key:3,"stroke-width":"3",class:i(["log-icon-mark","has-text-danger"+(w=="dark"?"-dark":"")])},null,8,["class"])):(n(),r(e(W),{key:4,"stroke-width":"3",class:i(["log-icon-mark","has-text-success"+(w=="dark"?"-dark":"")])},null,8,["class"]))])],2)]),_:2},1024)]))),128))])):(n(),c("div",xt,l(t.$t("message.no_result")),1))],64)}}};export{Nt as _};
