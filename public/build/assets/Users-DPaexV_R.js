import{C as V,a9 as x,N as R,r as f,v as C,o as E,Y as T,a3 as I,c as m,e as i,d as t,f as n,a1 as $,aa as O,j as h,k as p,m as u,h as W,t as l,g as z,R as M,E as Z,F as q,G as D,i as B,n as k,x as G}from"./app-CsCdPRLz.js";import{t as H}from"./tabs-CopbGQHR.js";import{U as P}from"./index-BpXPhS-I.js";import{C as Y}from"./circle-plus-BQbJ_-Ea.js";import"./createLucideIcon-B_q_KK3i.js";/*! 2FAuth version 6.0.0 - Copyright (c) 2025 Bubka - https://github.com/Bubka/2FAuth */const J={class:"options-tabs"},K={class:"title is-4 has-text-grey-light"},Q={class:"is-size-7-mobile"},X={class:"mb-6 mt-3"},ee={class:"columns"},se={class:"column pb-0"},te={class:"level is-mobile mb-0"},ae={class:"level-item has-text-centered is-justify-content-end"},oe={class:"subtitle is-7"},ne={class:"level-item has-text-centered is-justify-content-start"},ie={class:"buttons"},le={key:0},re={class:"has-ellipsis"},de={class:"is-block has-ellipsis is-family-primary is-size-6 is-size-7-mobile has-text-grey"},ue={class:"tags mt-2"},ce={class:"ml-3"},me={key:2,class:"mt-4 pl-3"},fe={__name:"Users",setup(he){const F=V(),L=R("2fauth"),N=G(),U=x(L.prefix+"returnTo","accounts"),y=f([]),o=f(""),g=f(!1),w=C(()=>y.value.filter(e=>{let s=e.name.toLowerCase().includes(c.value.keywords)||e.email.toLowerCase().includes(c.value.keywords);return c.value.admin!=null&&(s=s&&e.is_admin==c.value.admin),c.value.oauth!=null&&(s=s&&e.oauth_provider==c.value.oauth),s})),c=C(()=>{const e={admin:void 0,oauth:void 0,keywords:o.value.toLowerCase()},s=o.value.toLowerCase().split(" "),r=/admin:([01])/,v=/oauth:([a-zA-Z0-9])/;return s.forEach(d=>{d.match(r)&&(e.admin=parseInt(d.replace(r,"$1")),e.keywords=e.keywords.replace(d,"").trim()),d.match(v)&&(e.oauth=d.replace(v,"$1"),e.keywords=e.keywords.replace(d,"").trim())}),e});E(()=>{j()});function _(e){const s=/admin:([01])/,r=/oauth:([a-zA-Z0-9]*)/;o.value.match(s)&&e.match(s)?o.value=o.value.replace(s,e):c.value.oauth!=null&&e.match(r)?o.value=o.value.replace(r,e):o.value=o.value?o.value+" "+e:e}function j(){g.value=!0,T.getAll({returnError:!0}).then(e=>{y.value=e.data}).catch(e=>{F.show(e)}).finally(()=>{g.value=!1})}return I(e=>{e.name.startsWith("admin.")||N.clear()}),(e,s)=>{const r=p("RouterLink"),v=p("Spinner"),d=p("NavigationButton"),A=p("VueFooter"),S=p("FormWrapper");return u(),m("div",null,[i(n(O),{tabs:n(H),"active-tab":"admin.users",onTabSelected:s[0]||(s[0]=a=>("router"in e?e.router:n($)).push({name:a}))},null,8,["tabs"]),t("div",J,[i(S,null,{default:h(()=>[t("h4",K,l(e.$t("heading.users")),1),t("div",Q,l(e.$t("message.admin_users_legend")),1),t("div",X,[i(r,{class:"is-link mt-5",to:{name:"admin.createUser"}},{default:h(()=>[i(n(Y)),z(" "+l(e.$t("link.create_new_user")),1)]),_:1})]),t("div",ee,[t("div",se,[i(n(M),{keyword:n(o),"onUpdate:keyword":s[1]||(s[1]=a=>Z(o)?o.value=a:null),hasNoBackground:!0,placeholder:e.$t("placeholder.search_user_placeholder")},null,8,["keyword","placeholder"])])]),t("div",te,[t("div",ae,[t("p",oe,l(e.$t("message.quick_filters_colons")),1)]),t("div",ne,[t("div",ie,[t("button",{type:"button",class:"button is-small is-ghost p-0",onClick:s[2]||(s[2]=a=>_("admin:1"))},"admin"),t("button",{type:"button",class:"button is-small is-ghost p-0",onClick:s[3]||(s[3]=a=>_("oauth:github"))},"github"),t("button",{type:"button",class:"button is-small is-ghost p-0",onClick:s[4]||(s[4]=a=>_("oauth:openid"))},"openId")])])]),n(w).length>0?(u(),m("div",le,[(u(!0),m(q,null,D(n(w),a=>(u(),m("div",{key:a.id,class:"list-item is-size-5 is-size-6-mobile is-flex is-justify-content-space-between"},[i(n(P),null,{default:h(({mode:b})=>[t("div",re,[t("span",null,l(a.name),1),t("span",de,l(a.email),1),t("div",ue,[a.is_admin?(u(),m("span",{key:0,class:k(["tag is-rounded has-text-warning-dark",b=="dark"?"has-background-black-bis":"has-background-grey-lighter"])},"admin",2)):B("",!0),a.oauth_provider?(u(),m("span",{key:1,class:k(["tag is-rounded has-text-grey",b=="dark"?"has-background-black-bis":"has-background-grey-lighter"])},"oauth: "+l(a.oauth_provider),3)):B("",!0)])]),t("div",ce,[i(r,{to:{name:"admin.manageUser",params:{userId:a.id}},class:k(["button is-small has-normal-radius",{"is-dark":b=="dark"}]),title:e.$t("tooltip.manage")},{default:h(()=>[z(l(e.$t("link.manage")),1)]),_:1},8,["to","class","title"])])]),_:2},1024)]))),128))])):n(g)?(u(),W(v,{key:1,isVisible:!0,type:"list-loading"})):(u(),m("div",me,l(e.$t("message.no_result")),1)),i(A,null,{default:h(()=>[i(d,{action:"close",onClosed:s[5]||(s[5]=a=>("router"in e?e.router:n($)).push({name:n(U)})),"current-page-title":e.$t("title.admin.users")},null,8,["current-page-title"])]),_:1})]),_:1})])])}}};export{fe as default};
